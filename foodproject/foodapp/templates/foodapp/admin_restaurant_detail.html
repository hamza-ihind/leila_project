{% extends 'foodapp/base.html' %}
{% load static %}

{% block title %}Détails du Restaurant - {{ restaurant.name }}{% endblock %}

{% block extra_css %}
<style>
    .admin-detail-container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 30px 20px;
    }
    
    .admin-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 30px;
    }
    
    .admin-title {
        font-size: 28px;
        color: var(--primary-color);
        font-weight: 700;
    }
    
    .back-button {
        display: inline-flex;
        align-items: center;
        gap: 8px;
        padding: 10px 15px;
        background-color: var(--primary-color);
        color: white;
        border-radius: 5px;
        text-decoration: none;
        font-weight: 600;
        transition: background-color 0.3s;
    }
    
    .back-button:hover {
        background-color: #0056b3;
        color: white;
    }
    
    .restaurant-card {
        background-color: #fff;
        border-radius: 10px;
        box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        overflow: hidden;
        margin-bottom: 30px;
    }
    
    .restaurant-header {
        display: flex;
        padding: 20px;
        border-bottom: 1px solid #eee;
    }
    
    .restaurant-logo {
        width: 120px;
        height: 120px;
        border-radius: 10px;
        object-fit: cover;
        margin-right: 20px;
    }
    
    .restaurant-title-section {
        flex: 1;
    }
    
    .restaurant-name {
        font-size: 24px;
        font-weight: 700;
        color: var(--primary-color);
        margin-bottom: 5px;
        display: flex;
        align-items: center;
        gap: 10px;
    }
    
    .status-badge {
        font-size: 12px;
        padding: 5px 10px;
        border-radius: 20px;
        font-weight: 600;
    }
    
    .status-pending {
        background-color: #ffeaa7;
        color: #fdcb6e;
    }
    
    .status-approved {
        background-color: #55efc4;
        color: #00b894;
    }
    
    .status-sanctioned {
        background-color: #fab1a0;
        color: #e17055;
    }
    
    .status-banned {
        background-color: #ff7675;
        color: #d63031;
    }
    
    .status-rejected {
        background-color: #a29bfe;
        color: #6c5ce7;
    }
    
    .restaurant-meta {
        display: flex;
        flex-wrap: wrap;
        gap: 15px;
        margin-top: 10px;
    }
    
    .meta-item {
        display: flex;
        align-items: center;
        gap: 8px;
        font-size: 14px;
        color: #666;
    }
    
    .action-buttons {
        display: flex;
        gap: 10px;
        margin-top: 15px;
    }
    
    .btn-action {
        padding: 8px 15px;
        border-radius: 5px;
        font-weight: 600;
        font-size: 14px;
        cursor: pointer;
        border: none;
        display: inline-flex;
        align-items: center;
        gap: 8px;
        transition: all 0.3s;
    }
    
    .btn-approve {
        background-color: #55efc4;
        color: #00b894;
    }
    
    .btn-approve:hover {
        background-color: #00b894;
        color: white;
    }
    
    .btn-sanction {
        background-color: #fab1a0;
        color: #e17055;
    }
    
    .btn-sanction:hover {
        background-color: #e17055;
        color: white;
    }
    
    .btn-unsanction {
        background-color: #74b9ff;
        color: #0984e3;
    }
    
    .btn-unsanction:hover {
        background-color: #0984e3;
        color: white;
    }
    
    .btn-ban {
        background-color: #ff7675;
        color: #d63031;
    }
    
    .btn-ban:hover {
        background-color: #d63031;
        color: white;
    }
    
    .btn-view {
        background-color: #81ecec;
        color: #00cec9;
    }
    
    .btn-view:hover {
        background-color: #00cec9;
        color: white;
    }
    
    .detail-tabs {
        display: flex;
        border-bottom: 1px solid #eee;
        margin-bottom: 20px;
    }
    
    .detail-tab {
        padding: 15px 20px;
        cursor: pointer;
        font-weight: 600;
        color: #666;
        position: relative;
    }
    
    .detail-tab.active {
        color: var(--primary-color);
    }
    
    .detail-tab.active::after {
        content: '';
        position: absolute;
        bottom: -1px;
        left: 0;
        width: 100%;
        height: 3px;
        background-color: var(--primary-color);
    }
    
    .tab-content {
        display: none;
        padding: 20px;
    }
    
    .tab-content.active {
        display: block;
    }
    
    .info-section {
        margin-bottom: 25px;
    }
    
    .info-title {
        font-size: 18px;
        font-weight: 600;
        color: var(--primary-color);
        margin-bottom: 15px;
        display: flex;
        align-items: center;
        gap: 10px;
    }
    
    .info-grid {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 20px;
    }
    
    .info-item {
        display: flex;
        flex-direction: column;
    }
    
    .info-label {
        font-size: 14px;
        color: #666;
        margin-bottom: 5px;
    }
    
    .info-value {
        font-size: 16px;
        font-weight: 500;
    }
    
    .description-box {
        background-color: #f9f9f9;
        padding: 15px;
        border-radius: 5px;
        margin-top: 10px;
        line-height: 1.6;
    }
    
    .stats-grid {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 20px;
        margin-bottom: 25px;
    }
    
    .stat-card {
        background-color: #f9f9f9;
        border-radius: 10px;
        padding: 20px;
        text-align: center;
    }
    
    .stat-value {
        font-size: 28px;
        font-weight: 700;
        color: var(--primary-color);
        margin-bottom: 5px;
    }
    
    .stat-label {
        font-size: 14px;
        color: #666;
    }
    
    .history-item {
        display: flex;
        align-items: flex-start;
        gap: 15px;
        padding: 15px 0;
        border-bottom: 1px solid #eee;
    }
    
    .history-icon {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background-color: #f0f0f0;
        display: flex;
        align-items: center;
        justify-content: center;
        color: var(--primary-color);
    }
    
    .history-content {
        flex: 1;
    }
    
    .history-title {
        font-weight: 600;
        margin-bottom: 5px;
    }
    
    .history-date {
        font-size: 12px;
        color: #999;
    }
    
    .history-description {
        margin-top: 5px;
        font-size: 14px;
        color: #666;
    }
    
    .notes-form {
        margin-top: 20px;
    }
    
    .notes-textarea {
        width: 100%;
        padding: 15px;
        border: 1px solid #ddd;
        border-radius: 5px;
        resize: vertical;
        min-height: 100px;
        margin-bottom: 15px;
    }
    
    .btn-save-notes {
        background-color: var(--primary-color);
        color: white;
        padding: 10px 20px;
        border: none;
        border-radius: 5px;
        font-weight: 600;
        cursor: pointer;
        transition: background-color 0.3s;
    }
    
    .btn-save-notes:hover {
        background-color: #0056b3;
    }
    
    .admin-notes-list {
        margin-top: 20px;
    }
    
    .admin-note {
        background-color: #f9f9f9;
        padding: 15px;
        border-radius: 5px;
        margin-bottom: 15px;
    }
    
    .note-header {
        display: flex;
        justify-content: space-between;
        margin-bottom: 10px;
    }
    
    .note-author {
        font-weight: 600;
    }
    
    .note-date {
        font-size: 12px;
        color: #999;
    }
    
    .note-content {
        font-size: 14px;
        line-height: 1.5;
    }
</style>
{% endblock %}

{% block content %}
<div class="admin-detail-container">
    <div class="admin-header">
        <h1 class="admin-title">Détails du Restaurant</h1>
        <a href="{% url 'restaurant_lists' %}" class="back-button">
            <i class="fas fa-arrow-left"></i> Retour à la liste
        </a>
    </div>
    
    <div class="restaurant-card">
        <div class="restaurant-header">
            {% if restaurant_account.restaurant.logo %}
                <img src="{{ restaurant_account.restaurant.logo.url }}" alt="{{ restaurant_account.restaurant.name }}" class="restaurant-logo">
            {% else %}
                <img src="{% static 'foodapp/images/restaurant-placeholder.jpg' %}" alt="{{ restaurant_account.restaurant.name }}" class="restaurant-logo">
            {% endif %}
            
            <div class="restaurant-title-section">
                <h2 class="restaurant-name">
                    {{ restaurant_account.restaurant.name }}
                    {% if restaurant_account.pending_approval %}
                        <span class="status-badge status-pending">En attente</span>
                    {% elif restaurant_account.is_active and restaurant_account.restaurant.is_open %}
                        <span class="status-badge status-approved">Approuvé</span>
                    {% elif restaurant_account.is_active and not restaurant_account.restaurant.is_open %}
                        <span class="status-badge status-sanctioned">Sanctionné</span>
                    {% elif restaurant_account.status == 'banned' %}
                        <span class="status-badge status-banned">Banni</span>
                    {% elif restaurant_account.status == 'rejected' %}
                        <span class="status-badge status-rejected">Rejeté</span>
                    {% endif %}
                </h2>
                
                <div class="restaurant-meta">
                    <div class="meta-item">
                        <i class="fas fa-map-marker-alt"></i>
                        {{ restaurant_account.restaurant.address }}, {{ restaurant_account.restaurant.city.name }}
                    </div>
                    <div class="meta-item">
                        <i class="fas fa-phone"></i>
                        {{ restaurant_account.restaurant.phone }}
                    </div>
                    <div class="meta-item">
                        <i class="fas fa-envelope"></i>
                        {{ restaurant_account.restaurant.email }}
                    </div>
                    <div class="meta-item">
                        <i class="fas fa-user"></i>
                        {{ restaurant_account.user.first_name }} {{ restaurant_account.user.last_name }}
                    </div>
                    <div class="meta-item">
                        <i class="fas fa-calendar-alt"></i>
                        Inscrit le {{ restaurant_account.created_at|date:"d/m/Y" }}
                    </div>
                </div>
                
                <div class="action-buttons">
                    {% if restaurant_account.pending_approval %}
                        <button type="button" class="btn-action btn-approve" data-toggle="modal" data-target="#approveModal">
                            <i class="fas fa-check"></i> Approuver
                        </button>
                        <button type="button" class="btn-action btn-sanction" data-toggle="modal" data-target="#rejectModal">
                            <i class="fas fa-times"></i> Rejeter
                        </button>
                    {% elif restaurant_account.is_active and restaurant_account.restaurant.is_open %}
                        <button type="button" class="btn-action btn-sanction" data-toggle="modal" data-target="#sanctionModal">
                            <i class="fas fa-ban"></i> Sanctionner
                        </button>
                        <button type="button" class="btn-action btn-ban" data-toggle="modal" data-target="#banModal">
                            <i class="fas fa-user-slash"></i> Bannir
                        </button>
                    {% elif restaurant_account.is_active and not restaurant_account.restaurant.is_open %}
                        <button type="button" class="btn-action btn-unsanction" data-toggle="modal" data-target="#unsanctionModal">
                            <i class="fas fa-check"></i> Lever la sanction
                        </button>
                        <button type="button" class="btn-action btn-ban" data-toggle="modal" data-target="#banModal">
                            <i class="fas fa-user-slash"></i> Bannir
                        </button>
                    {% elif restaurant_account.status == 'banned' or restaurant_account.status == 'rejected' %}
                        <button type="button" class="btn-action btn-approve" data-toggle="modal" data-target="#reactivateModal">
                            <i class="fas fa-redo"></i> Réactiver
                        </button>
                    {% endif %}
                    <a href="{% url 'restaurant_detail' restaurant_account.restaurant.id %}" class="btn-action btn-view" target="_blank">
                        <i class="fas fa-external-link-alt"></i> Voir la page publique
                    </a>
                </div>
            </div>
        </div>
        
        <div class="detail-tabs">
            <div class="detail-tab active" data-tab="info"><i class="fas fa-info-circle"></i> Informations</div>
            <div class="detail-tab" data-tab="stats"><i class="fas fa-chart-bar"></i> Statistiques</div>
            <div class="detail-tab" data-tab="history"><i class="fas fa-history"></i> Historique</div>
            <div class="detail-tab" data-tab="notes"><i class="fas fa-sticky-note"></i> Notes administratives</div>
        </div>
        
        <div class="tab-content active" id="tab-info">
            <div class="info-section">
                <h3 class="info-title"><i class="fas fa-building"></i> Informations du restaurant</h3>
                <div class="info-grid">
                    <div class="info-item">
                        <span class="info-label">Nom du restaurant</span>
                        <span class="info-value">{{ restaurant_account.restaurant.name }}</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Ville</span>
                        <span class="info-value">{{ restaurant_account.restaurant.city.name }}</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Adresse</span>
                        <span class="info-value">{{ restaurant_account.restaurant.address }}</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Téléphone</span>
                        <span class="info-value">{{ restaurant_account.restaurant.phone }}</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Email</span>
                        <span class="info-value">{{ restaurant_account.restaurant.email }}</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Site web</span>
                        <span class="info-value">
                            {% if restaurant_account.restaurant.website %}
                                <a href="{{ restaurant_account.restaurant.website }}" target="_blank">{{ restaurant_account.restaurant.website }}</a>
                            {% else %}
                                Non renseigné
                            {% endif %}
                        </span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Capacité</span>
                        <span class="info-value">{{ restaurant_account.restaurant.capacity }} personnes</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Statut</span>
                        <span class="info-value">
                            {% if restaurant_account.pending_approval %}
                                En attente d'approbation
                            {% elif restaurant_account.is_active and restaurant_account.restaurant.is_open %}
                                Actif et ouvert
                            {% else %}
                                Sanctionné (fermé temporairement)
                            {% endif %}
                        </span>
                    </div>
                </div>
                
                <div class="info-item" style="margin-top: 20px;">
                    <span class="info-label">Description</span>
                    <div class="description-box">
                        {{ restaurant_account.restaurant.description|default:"Aucune description disponible" }}
                    </div>
                </div>
            </div>
            
            <div class="info-section">
                <h3 class="info-title"><i class="fas fa-user"></i> Informations du propriétaire</h3>
                <div class="info-grid">
                    <div class="info-item">
                        <span class="info-label">Nom d'utilisateur</span>
                        <span class="info-value">{{ restaurant_account.user.username }}</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Nom complet</span>
                        <span class="info-value">{{ restaurant_account.user.first_name }} {{ restaurant_account.user.last_name }}</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Email</span>
                        <span class="info-value">{{ restaurant_account.user.email }}</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Date d'inscription</span>
                        <span class="info-value">{{ restaurant_account.created_at|date:"d/m/Y H:i" }}</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Type de compte</span>
                        <span class="info-value">{{ restaurant_account.get_account_type_display }}</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Dernière connexion</span>
                        <span class="info-value">
                            {% if restaurant_account.last_login %}
                                {{ restaurant_account.last_login|date:"d/m/Y H:i" }}
                            {% else %}
                                Jamais connecté
                            {% endif %}
                        </span>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="tab-content" id="tab-stats">
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-value">{{ orders_count|default:"0" }}</div>
                    <div class="stat-label">Commandes totales</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">{{ reviews_count|default:"0" }}</div>
                    <div class="stat-label">Avis clients</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">{{ average_rating|default:"0" }}</div>
                    <div class="stat-label">Note moyenne</div>
                </div>
            </div>
            
            <div class="info-section">
                <h3 class="info-title"><i class="fas fa-utensils"></i> Menu et plats</h3>
                <div class="info-grid">
                    <div class="info-item">
                        <span class="info-label">Nombre de plats</span>
                        <span class="info-value">{{ dishes_count|default:"0" }}</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Catégories</span>
                        <span class="info-value">{{ categories_count|default:"0" }}</span>
                    </div>
                </div>
                
                {% if dishes %}
                <div style="margin-top: 20px;">
                    <h4 style="font-size: 16px; margin-bottom: 10px;">Plats populaires</h4>
                    <ul style="list-style: none; padding: 0;">
                        {% for dish in dishes|slice:":5" %}
                        <li style="padding: 8px 0; border-bottom: 1px solid #eee;">
                            {{ dish.name }} - {{ dish.price }} DH
                        </li>
                        {% endfor %}
                    </ul>
                </div>
                {% endif %}
            </div>
        </div>
        
        <div class="tab-content" id="tab-history">
            <div class="info-section">
                <h3 class="info-title"><i class="fas fa-history"></i> Historique des actions</h3>
                
                <div class="history-list">
                    {% if history_items %}
                        {% for item in history_items %}
                        <div class="history-item">
                            <div class="history-icon">
                                <i class="{{ item.icon }}"></i>
                            </div>
                            <div class="history-content">
                                <div class="history-title">{{ item.title }}</div>
                                <div class="history-date">{{ item.date|date:"d/m/Y H:i" }}</div>
                                <div class="history-description">{{ item.description }}</div>
                            </div>
                        </div>
                        {% endfor %}
                    {% else %}
                        <p>Aucun historique disponible pour ce restaurant.</p>
                    {% endif %}
                </div>
            </div>
        </div>
        
        <div class="tab-content" id="tab-notes">
            <div class="info-section">
                <h3 class="info-title"><i class="fas fa-sticky-note"></i> Notes administratives</h3>
                
                <form method="post" action="{% url 'add_restaurant_note' restaurant_account.id %}" class="notes-form">
                    {% csrf_token %}
                    <textarea name="note_content" class="notes-textarea" placeholder="Ajouter une note administrative..."></textarea>
                    <button type="submit" class="btn-save-notes">Enregistrer la note</button>
                </form>
                
                <div class="admin-notes-list">
                    {% if admin_notes %}
                        {% for note in admin_notes %}
                        <div class="admin-note">
                            <div class="note-header">
                                <div class="note-author">{{ note.admin.username }}</div>
                                <div class="note-date">{{ note.created_at|date:"d/m/Y H:i" }}</div>
                            </div>
                            <div class="note-content">{{ note.content }}</div>
                        </div>
                        {% endfor %}
                    {% else %}
                        <p>Aucune note administrative pour ce restaurant.</p>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Modals pour les actions -->
<div class="modal fade" id="approveModal" tabindex="-1" role="dialog" aria-labelledby="approveModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="approveModalLabel">Approuver le restaurant</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <form method="POST" action="{% url 'update_restaurant_status' restaurant_account.id %}">
                {% csrf_token %}
                <input type="hidden" name="status" value="approved">
                <div class="modal-body">
                    <p>Vous êtes sur le point d'approuver le restaurant <strong>{{ restaurant_account.restaurant.name }}</strong>.</p>
                    <div class="form-group">
                        <label for="approveReason">Commentaire (optionnel)</label>
                        <textarea class="form-control" id="approveReason" name="reason" rows="3"></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Annuler</button>
                    <button type="submit" class="btn btn-success">Approuver</button>
                </div>
            </form>
        </div>
    </div>
</div>

<div class="modal fade" id="rejectModal" tabindex="-1" role="dialog" aria-labelledby="rejectModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="rejectModalLabel">Rejeter le restaurant</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <form method="POST" action="{% url 'update_restaurant_status' restaurant_account.id %}">
                {% csrf_token %}
                <input type="hidden" name="status" value="rejected">
                <div class="modal-body">
                    <p>Vous êtes sur le point de rejeter le restaurant <strong>{{ restaurant_account.restaurant.name }}</strong>.</p>
                    <div class="form-group">
                        <label for="rejectReason">Raison du rejet <span class="text-danger">*</span></label>
                        <textarea class="form-control" id="rejectReason" name="reason" rows="3" required></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Annuler</button>
                    <button type="submit" class="btn btn-danger">Rejeter</button>
                </div>
            </form>
        </div>
    </div>
</div>

<div class="modal fade" id="sanctionModal" tabindex="-1" role="dialog" aria-labelledby="sanctionModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="sanctionModalLabel">Sanctionner le restaurant</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <form method="POST" action="{% url 'update_restaurant_status' restaurant_account.id %}">
                {% csrf_token %}
                <input type="hidden" name="status" value="sanctioned">
                <div class="modal-body">
                    <p>Vous êtes sur le point de sanctionner le restaurant <strong>{{ restaurant_account.restaurant.name }}</strong>. Le restaurant restera actif mais ne pourra pas accepter de nouvelles commandes.</p>
                    <div class="form-group">
                        <label for="sanctionReason">Raison de la sanction <span class="text-danger">*</span></label>
                        <textarea class="form-control" id="sanctionReason" name="reason" rows="3" required></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Annuler</button>
                    <button type="submit" class="btn btn-warning">Sanctionner</button>
                </div>
            </form>
        </div>
    </div>
</div>

<div class="modal fade" id="unsanctionModal" tabindex="-1" role="dialog" aria-labelledby="unsanctionModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="unsanctionModalLabel">Lever la sanction</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <form method="POST" action="{% url 'update_restaurant_status' restaurant_account.id %}">
                {% csrf_token %}
                <input type="hidden" name="status" value="approved">
                <div class="modal-body">
                    <p>Vous êtes sur le point de lever la sanction du restaurant <strong>{{ restaurant_account.restaurant.name }}</strong>. Le restaurant pourra à nouveau accepter des commandes.</p>
                    <div class="form-group">
                        <label for="unsanctionReason">Commentaire (optionnel)</label>
                        <textarea class="form-control" id="unsanctionReason" name="reason" rows="3"></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Annuler</button>
                    <button type="submit" class="btn btn-success">Lever la sanction</button>
                </div>
            </form>
        </div>
    </div>
</div>

<div class="modal fade" id="banModal" tabindex="-1" role="dialog" aria-labelledby="banModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="banModalLabel">Bannir le restaurant</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <form method="POST" action="{% url 'update_restaurant_status' restaurant_account.id %}">
                {% csrf_token %}
                <input type="hidden" name="status" value="banned">
                <div class="modal-body">
                    <p>Vous êtes sur le point de bannir le restaurant <strong>{{ restaurant_account.restaurant.name }}</strong>. Le restaurant sera désactivé et ne pourra plus se connecter.</p>
                    <div class="form-group">
                        <label for="banReason">Raison du bannissement <span class="text-danger">*</span></label>
                        <textarea class="form-control" id="banReason" name="reason" rows="3" required></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Annuler</button>
                    <button type="submit" class="btn btn-danger">Bannir</button>
                </div>
            </form>
        </div>
    </div>
</div>

<div class="modal fade" id="reactivateModal" tabindex="-1" role="dialog" aria-labelledby="reactivateModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="reactivateModalLabel">Réactiver le restaurant</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <form method="POST" action="{% url 'update_restaurant_status' restaurant_account.id %}">
                {% csrf_token %}
                <input type="hidden" name="status" value="approved">
                <div class="modal-body">
                    <p>Vous êtes sur le point de réactiver le restaurant <strong>{{ restaurant_account.restaurant.name }}</strong>.</p>
                    <div class="form-group">
                        <label for="reactivateReason">Commentaire (optionnel)</label>
                        <textarea class="form-control" id="reactivateReason" name="reason" rows="3"></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Annuler</button>
                    <button type="submit" class="btn btn-success">Réactiver</button>
                </div>
            </form>
        </div>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Gestion des onglets
        const tabs = document.querySelectorAll('.detail-tab');
        const tabContents = document.querySelectorAll('.tab-content');
        
        tabs.forEach(tab => {
            tab.addEventListener('click', function() {
                // Retirer la classe active de tous les onglets
                tabs.forEach(t => t.classList.remove('active'));
                tabContents.forEach(c => c.classList.remove('active'));
                
                // Ajouter la classe active à l'onglet cliqué
                this.classList.add('active');
                
                // Afficher le contenu correspondant
                const tabId = 'tab-' + this.getAttribute('data-tab');
                document.getElementById(tabId).classList.add('active');
            });
        });
        
        // Activer les tooltips Bootstrap
        $('[data-toggle="tooltip"]').tooltip();
    });
</script>
{% endblock %}